function Point(e, t) { this.x = e, this.y = t } function __wpTranslateOffset(e, t, n, i, r) { for (; "undefined" != typeof n && null != n && n != i;) { e += n.offsetLeft, t += n.offsetTop; var o = n.tagName; "TABLE" != o && "BODY" != o && (e += n.clientLeft, t += n.clientTop), r && "BODY" != o && (e -= n.scrollLeft, t -= n.scrollTop), n = n.offsetParent } return new Point(e, t) } function __wpGetPageEventLocation(e, t) { return ("undefined" == typeof e || null == e) && (e = window.event), __wpTranslateOffset(e.offsetX, e.offsetY, e.srcElement, null, t) } function __wpClearSelection() { document.selection.empty() } function WebPart(e, t, n, i, r) { this.webPartElement = e, this.allowZoneChange = r, this.zone = n, this.zoneIndex = i, this.title = "undefined" != typeof t && null != t ? t.innerText : "", e.__webPart = this, "undefined" != typeof t && null != t && (t.style.cursor = "move", t.attachEvent("onmousedown", WebPart_OnMouseDown), e.attachEvent("ondragstart", WebPart_OnDragStart), e.attachEvent("ondrag", WebPart_OnDrag), e.attachEvent("ondragend", WebPart_OnDragEnd)), this.UpdatePosition = WebPart_UpdatePosition, this.Dispose = WebPart_Dispose } function WebPart_Dispose() { this.webPartElement.__webPart = null } function WebPart_OnMouseDown() { var e = window.event, t = WebPart_GetParentWebPartElement(e.srcElement); if ("undefined" != typeof t && null != t) { document.selection.empty(); try { __wpm.draggedWebPart = t, __wpm.DragDrop() } catch (n) { __wpm.draggedWebPart = t, window.setTimeout("__wpm.DragDrop()", 0) } e.returnValue = !1, e.cancelBubble = !0 } } function WebPart_OnDragStart() { var e = window.event, t = e.srcElement; if ("undefined" == typeof t.__webPart || null == t.__webPart) return e.returnValue = !1, e.cancelBubble = !0, void 0; var n = e.dataTransfer; n.effectAllowed = __wpm.InitiateWebPartDragDrop(t) } function WebPart_OnDrag() { __wpm.ContinueWebPartDragDrop() } function WebPart_OnDragEnd() { __wpm.CompleteWebPartDragDrop() } function WebPart_GetParentWebPartElement(e) { for (var t = e; ("undefined" == typeof t.__webPart || null == t.__webPart) && (t = t.parentElement, "undefined" != typeof t && null != t) ;); return t } function WebPart_UpdatePosition() { var e = __wpTranslateOffset(0, 0, this.webPartElement, null, !1); this.middleX = e.x + this.webPartElement.offsetWidth / 2, this.middleY = e.y + this.webPartElement.offsetHeight / 2 } function Zone(e, t, n, i, r, o) { var s = null; webPartTableContainer = 1 == e.rows.length ? e.rows[0].cells[0] : e.rows[1].cells[0]; var a; for (a = 0; a < webPartTableContainer.childNodes.length; a++) { var l = webPartTableContainer.childNodes[a]; if ("TABLE" == l.tagName) { s = l; break } } if (this.zoneElement = e, this.zoneIndex = t, this.webParts = new Array, this.uniqueID = n, this.isVertical = i, this.allowLayoutChange = r, this.allowDrop = !1, this.webPartTable = s, this.highlightColor = o, this.savedBorderColor = null != s ? s.style.borderColor : null, this.dropCueElements = new Array, null != s) if (i) for (a = 0; a < s.rows.length; a += 2) this.dropCueElements[a / 2] = s.rows[a].cells[0].childNodes[0]; else for (a = 0; a < s.rows[0].cells.length; a += 2) this.dropCueElements[a / 2] = s.rows[0].cells[a].childNodes[0]; this.AddWebPart = Zone_AddWebPart, this.GetWebPartIndex = Zone_GetWebPartIndex, this.ToggleDropCues = Zone_ToggleDropCues, this.UpdatePosition = Zone_UpdatePosition, this.Dispose = Zone_Dispose, s.__zone = this, s.attachEvent("ondragenter", Zone_OnDragEnter), s.attachEvent("ondrop", Zone_OnDrop) } function Zone_Dispose() { for (var e = 0; e < this.webParts.length; e++) this.webParts[e].Dispose(); this.webPartTable.__zone = null } function Zone_OnDragEnter() { var e = __wpm.ProcessWebPartDragEnter(), t = window.event; e && (t.returnValue = !1, t.cancelBubble = !0) } function Zone_OnDragOver() { var e = __wpm.ProcessWebPartDragOver(), t = window.event; e && (t.returnValue = !1, t.cancelBubble = !0) } function Zone_OnDrop() { var e = __wpm.ProcessWebPartDrop(), t = window.event; e && (t.returnValue = !1, t.cancelBubble = !0) } function Zone_GetParentZoneElement(e) { for (var t = e; ("undefined" == typeof t.__zone || null == t.__zone) && (t = t.parentElement, "undefined" != typeof t && null != t) ;); return t } function Zone_AddWebPart(e, t, n) { var i = null, r = this.webParts.length; return i = this.allowLayoutChange && __wpm.IsDragDropEnabled() ? new WebPart(e, t, this, r, n) : new WebPart(e, null, this, r, n), this.webParts[r] = i, i } function Zone_ToggleDropCues(e, t, n) { if (0 == n && (this.webPartTable.style.borderColor = e ? this.highlightColor : this.savedBorderColor), -1 != t) { var i = this.dropCueElements[t]; if (i && i.style) { if ("100%" == i.style.height && !i.webPartZoneHorizontalCueResized) { var r = i.parentElement.clientHeight, o = r - 10; i.style.height = o + "px"; var s = i.getElementsByTagName("DIV")[0]; if (s && s.style) { s.style.height = i.style.height; var a = i.parentElement.clientHeight - r; a && (i.style.height = o - a + "px", s.style.height = i.style.height) } i.webPartZoneHorizontalCueResized = !0 } i.style.visibility = e ? "visible" : "hidden" } } } function Zone_GetWebPartIndex(e) { var t = e.x, n = e.y; if (t < this.webPartTableLeft || t > this.webPartTableRight || n < this.webPartTableTop || n > this.webPartTableBottom) return -1; for (var i = this.isVertical, r = this.webParts, o = r.length, s = 0; o > s; s++) { var a = r[s]; if (i) { if (n < a.middleY) return s } else if (t < a.middleX) return s } return o } function Zone_UpdatePosition() { var e = __wpTranslateOffset(0, 0, this.webPartTable, null, !1); this.webPartTableLeft = e.x, this.webPartTableTop = e.y, this.webPartTableRight = null != this.webPartTable ? e.x + this.webPartTable.offsetWidth : e.x, this.webPartTableBottom = null != this.webPartTable ? e.y + this.webPartTable.offsetHeight : e.y; for (var t = 0; t < this.webParts.length; t++) this.webParts[t].UpdatePosition() } function WebPartDragState(e, t) { this.webPartElement = e, this.dropZoneElement = null, this.dropIndex = -1, this.effect = t, this.dropped = !1 } function WebPartMenu(e, t, n) { this.menuLabelElement = e, this.menuDropDownElement = t, this.menuElement = n, this.menuLabelElement.__menu = this, this.menuLabelElement.attachEvent("onclick", WebPartMenu_OnClick), this.menuLabelElement.attachEvent("onkeypress", WebPartMenu_OnKeyPress), this.menuLabelElement.attachEvent("onmouseenter", WebPartMenu_OnMouseEnter), this.menuLabelElement.attachEvent("onmouseleave", WebPartMenu_OnMouseLeave), "undefined" != typeof this.menuDropDownElement && null != this.menuDropDownElement && (this.menuDropDownElement.__menu = this), this.menuItemStyle = "", this.menuItemHoverStyle = "", this.popup = null, this.hoverClassName = "", this.hoverColor = "", this.oldColor = this.menuLabelElement.style.color, this.oldTextDecoration = this.menuLabelElement.style.textDecoration, this.oldClassName = this.menuLabelElement.className, this.Show = WebPartMenu_Show, this.Hide = WebPartMenu_Hide, this.Hover = WebPartMenu_Hover, this.Unhover = WebPartMenu_Unhover, this.Dispose = WebPartMenu_Dispose; var i = this; this.disposeDelegate = function () { i.Dispose() }, window.attachEvent("onunload", this.disposeDelegate) } function WebPartMenu_Dispose() { this.menuLabelElement.__menu = null, this.menuDropDownElement.__menu = null, window.detachEvent("onunload", this.disposeDelegate) } function WebPartMenu_Show() { "undefined" != typeof __wpm.menu && null != __wpm.menu && __wpm.menu.Hide(); var e = "<html><head><style>a.menuItem, a.menuItem:Link { display: block; padding: 1px; text-decoration: none; " + this.itemStyle + " }" + "a.menuItem:Hover { " + this.itemHoverStyle + " }" + '</style><body scroll="no" style="border: none; margin: 0; padding: 0;" ondragstart="window.event.returnValue=false;" onclick="popup.hide()">' + this.menuElement.innerHTML + "</body></html>", t = 16, n = 16; this.popup = window.createPopup(), __wpm.menu = this; var i = this.popup.document; i.write(e), this.popup.show(0, 0, t, n); var r = i.body; t = r.scrollWidth, n = r.scrollHeight, t < this.menuLabelElement.offsetWidth && (t = this.menuLabelElement.offsetWidth + 16), -1 != this.menuElement.innerHTML.indexOf("progid:DXImageTransform.Microsoft.Shadow") && (r.style.paddingRight = "4px"), r.__wpm = __wpm, r.__wpmDeleteWarning = __wpmDeleteWarning, r.__wpmCloseProviderWarning = __wpmCloseProviderWarning, r.popup = this.popup, this.popup.hide(), this.popup.show(0, this.menuLabelElement.offsetHeight, t, n, this.menuLabelElement) } function WebPartMenu_Hide() { __wpm.menu == this && (__wpm.menu = null, "undefined" != typeof this.popup && null != this.popup && (this.popup.hide(), this.popup = null)) } function WebPartMenu_Hover() { "" != this.labelHoverClassName && (this.menuLabelElement.className = this.menuLabelElement.className + " " + this.labelHoverClassName), "" != this.labelHoverColor && (this.menuLabelElement.style.color = this.labelHoverColor) } function WebPartMenu_Unhover() { "" != this.labelHoverClassName && (this.menuLabelElement.style.textDecoration = this.oldTextDecoration, this.menuLabelElement.className = this.oldClassName), "" != this.labelHoverColor && (this.menuLabelElement.style.color = this.oldColor) } function WebPartMenu_OnClick() { var e = window.event.srcElement.__menu; "undefined" != typeof e && null != e && (window.event.returnValue = !1, window.event.cancelBubble = !0, e.Show()) } function WebPartMenu_OnKeyPress() { if (13 == window.event.keyCode) { var e = window.event.srcElement.__menu; "undefined" != typeof e && null != e && (window.event.returnValue = !1, window.event.cancelBubble = !0, e.Show()) } } function WebPartMenu_OnMouseEnter() { var e = window.event.srcElement.__menu; "undefined" != typeof e && null != e && e.Hover() } function WebPartMenu_OnMouseLeave() { var e = window.event.srcElement.__menu; "undefined" != typeof e && null != e && e.Unhover() } function WebPartManager() { this.overlayContainerElement = null, this.zones = new Array, this.dragState = null, this.menu = null, this.draggedWebPart = null, this.AddZone = WebPartManager_AddZone, this.IsDragDropEnabled = WebPartManager_IsDragDropEnabled, this.DragDrop = WebPartManager_DragDrop, this.InitiateWebPartDragDrop = WebPartManager_InitiateWebPartDragDrop, this.CompleteWebPartDragDrop = WebPartManager_CompleteWebPartDragDrop, this.ContinueWebPartDragDrop = WebPartManager_ContinueWebPartDragDrop, this.ProcessWebPartDragEnter = WebPartManager_ProcessWebPartDragEnter, this.ProcessWebPartDragOver = WebPartManager_ProcessWebPartDragOver, this.ProcessWebPartDrop = WebPartManager_ProcessWebPartDrop, this.ShowHelp = WebPartManager_ShowHelp, this.ExportWebPart = WebPartManager_ExportWebPart, this.Execute = WebPartManager_Execute, this.SubmitPage = WebPartManager_SubmitPage, this.UpdatePositions = WebPartManager_UpdatePositions, window.attachEvent("onunload", WebPartManager_Dispose) } function WebPartManager_Dispose() { for (var e = 0; e < __wpm.zones.length; e++) __wpm.zones[e].Dispose(); window.detachEvent("onunload", WebPartManager_Dispose) } function WebPartManager_AddZone(e, t, n, i, r) { var o = this.zones.length, s = new Zone(e, o, t, n, i, r); return this.zones[o] = s, s } function WebPartManager_IsDragDropEnabled() { return "undefined" != typeof this.overlayContainerElement && null != this.overlayContainerElement } function WebPartManager_DragDrop() { if ("undefined" != typeof this.draggedWebPart && null != this.draggedWebPart) { var e = this.draggedWebPart; this.draggedWebPart = null, e.dragDrop(), window.setTimeout("__wpClearSelection()", 0) } } function WebPartManager_InitiateWebPartDragDrop(e) { var t = e.__webPart; this.UpdatePositions(), this.dragState = new WebPartDragState(e, "move"); var n = __wpGetPageEventLocation(window.event, !0), i = this.overlayContainerElement; if (i.style.left = n.x - e.offsetWidth / 2, i.style.top = n.y + 4 + (e.clientTop ? e.clientTop : 0), i.style.display = "block", i.style.width = e.offsetWidth, i.style.height = e.offsetHeight, i.appendChild(e.cloneNode(!0)), 0 == t.allowZoneChange) t.zone.allowDrop = !0; else for (var r = 0; r < __wpm.zones.length; r++) { var o = __wpm.zones[r]; o.allowLayoutChange && (o.allowDrop = !0) } return document.body.attachEvent("ondragover", Zone_OnDragOver), "move" } function WebPartManager_CompleteWebPartDragDrop() { var e = this.dragState; this.dragState = null, "undefined" != typeof e.dropZoneElement && null != e.dropZoneElement && e.dropZoneElement.__zone.ToggleDropCues(!1, e.dropIndex, !1), document.body.detachEvent("ondragover", Zone_OnDragOver); for (var t = 0; t < __wpm.zones.length; t++) __wpm.zones[t].allowDrop = !1; if (this.overlayContainerElement.removeChild(this.overlayContainerElement.firstChild), this.overlayContainerElement.style.display = "none", "undefined" != typeof e && null != e && 1 == e.dropped) { var n = e.webPartElement.__webPart.zone, i = e.webPartElement.__webPart.zoneIndex; if (n != e.dropZoneElement.__zone || i != e.dropIndex && i != e.dropIndex - 1) { var r = e.dropZoneElement.__zone.uniqueID, o = "Drag:" + e.webPartElement.id + ":" + e.dropIndex; this.SubmitPage(r, o) } } } function WebPartManager_ContinueWebPartDragDrop() { var e = this.dragState; if ("undefined" != typeof e && null != e) { var t = this.overlayContainerElement.style, n = __wpGetPageEventLocation(window.event, !0); t.left = n.x - e.webPartElement.offsetWidth / 2, t.top = n.y + 4 + (e.webPartElement.clientTop ? e.webPartElement.clientTop : 0) } } function WebPartManager_Execute(e) { this.menu && this.menu.Hide(); var t = new Function(e); return 0 != t() } function WebPartManager_ProcessWebPartDragEnter() { var e = __wpm.dragState; if ("undefined" != typeof e && null != e) { var t = window.event, n = Zone_GetParentZoneElement(t.srcElement); ("undefined" == typeof n.__zone || null == n.__zone || 0 == n.__zone.allowDrop) && (n = null); var i = -1; return "undefined" != typeof n && null != n && (i = n.__zone.GetWebPartIndex(__wpGetPageEventLocation(t, !1)), -1 == i && (n = null)), e.dropZoneElement != n ? ("undefined" != typeof e.dropZoneElement && null != e.dropZoneElement && e.dropZoneElement.__zone.ToggleDropCues(!1, e.dropIndex, !1), e.dropZoneElement = n, e.dropIndex = i, "undefined" != typeof n && null != n && n.__zone.ToggleDropCues(!0, i, !1)) : e.dropIndex != i && (-1 != e.dropIndex && e.dropZoneElement.__zone.ToggleDropCues(!1, e.dropIndex, !1), e.dropIndex = i, "undefined" != typeof n && null != n && n.__zone.ToggleDropCues(!0, i, !1)), "undefined" != typeof e.dropZoneElement && null != e.dropZoneElement && (t.dataTransfer.effectAllowed = e.effect), !0 } return !1 } function WebPartManager_ProcessWebPartDragOver() { var e = __wpm.dragState, t = window.event, n = !1; if ("undefined" != typeof e && null != e && "undefined" != typeof e.dropZoneElement && null != e.dropZoneElement) { var i = Zone_GetParentZoneElement(t.srcElement); if ("undefined" != typeof i && null != i && 0 == i.__zone.allowDrop && (i = null), "undefined" != typeof i && null != i || "undefined" == typeof e.dropZoneElement || null == e.dropZoneElement) { if ("undefined" != typeof i && null != i) { var r = __wpGetPageEventLocation(t, !1), o = i.__zone.GetWebPartIndex(r); -1 == o && (i = null), e.dropZoneElement != i ? ((-1 != e.dropIndex || "undefined" == typeof i || null == i) && e.dropZoneElement.__zone.ToggleDropCues(!1, __wpm.dragState.dropIndex, !1), e.dropZoneElement = i) : e.dropZoneElement.__zone.ToggleDropCues(!1, e.dropIndex, !0), e.dropIndex = o, "undefined" != typeof i && null != i && i.__zone.ToggleDropCues(!0, o, !1) } } else e.dropZoneElement.__zone.ToggleDropCues(!1, __wpm.dragState.dropIndex, !1), e.dropZoneElement = null, e.dropIndex = -1; n = !0 } return ("undefined" == typeof e || null == e || "undefined" == typeof e.dropZoneElement || null == e.dropZoneElement) && (t.dataTransfer.effectAllowed = "none"), n } function WebPartManager_ProcessWebPartDrop() { var e = this.dragState; if ("undefined" != typeof e && null != e) { var t = window.event, n = Zone_GetParentZoneElement(t.srcElement); return "undefined" != typeof n && null != n && 0 == n.__zone.allowDrop && (n = null), "undefined" != typeof n && null != n && e.dropZoneElement == n && (e.dropped = !0), !0 } return !1 } function WebPartManager_ShowHelp(e, t) { if ("undefined" != typeof this.menu && null != this.menu && this.menu.Hide(), 0 == t || 1 == t) if (0 == t) { var n = "edge: Sunken; center: yes; help: no; resizable: yes; status: no"; window.showModalDialog(e, null, n) } else window.open(e, null, "scrollbars=yes,resizable=yes,status=no,toolbar=no,menubar=no,location=no"); else 2 == t && (window.location = e) } function WebPartManager_ExportWebPart(e, t, n) { return 1 == t && __wpmExportWarning.length > 0 && 1 != this.personalizationScopeShared && 0 == confirm(__wpmExportWarning) ? !1 : (0 == n && (window.location = e), !0) } function WebPartManager_UpdatePositions() { for (var e = 0; e < this.zones.length; e++) this.zones[e].UpdatePosition() } function WebPartManager_SubmitPage(e, t) { "undefined" != typeof this.menu && null != this.menu && this.menu.Hide(), __doPostBack(e, t) } var __wpm = null;