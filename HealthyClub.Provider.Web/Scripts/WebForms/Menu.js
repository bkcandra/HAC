function Menu_ClearInterval() { __menuInterval && window.clearInterval(__menuInterval) } function Menu_Collapse(e) { Menu_SetRoot(e), __rootMenuItem && (Menu_ClearInterval(), __disappearAfter >= 0 && (__menuInterval = window.setInterval("Menu_HideItems()", __disappearAfter))) } function Menu_Expand(e, t, i, a) { Menu_ClearInterval(); var n = e.parentNode.parentNode.parentNode.parentNode.parentNode, r = !0; n.id || (r = !1, n = n.parentNode); var s = Menu_FindSubMenu(e); if (s) { var o = Menu_GetData(e); if (!o) return null; s.rel = n.id, s.x = t, s.y = i, r && (s.pos = "bottom"), PopOut_Show(s.id, a, o) } return Menu_SetRoot(e), s && (!document.body.__oldOnClick && document.body.onclick && (document.body.__oldOnClick = document.body.onclick), __rootMenuItem && (document.body.onclick = Menu_HideItems)), Menu_ResetSiblings(n), s } function Menu_FindMenu(e) { if (e && e.menu) return e.menu; var t = e.parentNode.parentNode.parentNode.parentNode.parentNode; t.id || (t = t.parentNode); for (var i = t.id.length - 1; i >= 0; i--) if (t.id.charAt(i) < "0" || t.id.charAt(i) > "9") { var a = WebForm_GetElementById(t.id.substr(0, i)); if (a) return e.menu = a, a } return null } function Menu_FindNext(e) { var t = WebForm_GetElementByTagName(e, "A"), i = Menu_FindParentContainer(e), a = null; if (i) for (var n = WebForm_GetElementsByTagName(i, "A"), r = !1, s = 0; s < n.length; s++) { var o = n[s]; if (Menu_IsSelectable(o)) { if (Menu_FindParentContainer(o) == i) { if (r) return o; a || (a = o) } r || o != t || (r = !0) } } return a } function Menu_FindParentContainer(e) { if (e.menu_ParentContainerCache) return e.menu_ParentContainerCache; var t = "a" == e.tagName.toLowerCase() ? e : WebForm_GetElementByTagName(e, "A"), i = Menu_FindMenu(t); if (i) { for (var a = e; a && a.tagName && a.id != i.id && "div" != a.tagName.toLowerCase() ;) a = a.parentNode; return e.menu_ParentContainerCache = a, a } } function Menu_FindParentItem(e) { var t = Menu_FindParentContainer(e), i = t.id, a = i.length; if (i && "Items" == i.substr(a - 5)) { var n = i.substr(0, a - 5); return WebForm_GetElementById(n) } return null } function Menu_FindPrevious(e) { var t = WebForm_GetElementByTagName(e, "A"), i = Menu_FindParentContainer(e), a = null; if (i) for (var n = WebForm_GetElementsByTagName(i, "A"), r = 0; r < n.length; r++) { var s = n[r]; if (Menu_IsSelectable(s)) { if (s == t && a) return a; Menu_FindParentContainer(s) == i && (a = s) } } return a } function Menu_FindSubMenu(e) { var t = e.parentNode.parentNode.parentNode.parentNode.parentNode; return t.id || (t = t.parentNode), WebForm_GetElementById(t.id + "Items") } function Menu_Focus(e) { if (e && e.focus) { var t = WebForm_GetElementPosition(e), i = Menu_FindParentContainer(e); i.offset || (i.offset = 0); var a, n = WebForm_GetElementPosition(i); t.y + t.height > n.y + i.offset + i.clippedHeight ? (a = t.y + t.height - n.y - i.offset - i.clippedHeight, PopOut_Scroll(i, a)) : t.y < n.y + i.offset && (a = n.y + i.offset - t.y, PopOut_Scroll(i, -a)), PopOut_HideScrollers(i), e.focus() } } function Menu_GetData(item) { if (!item.data) { var a = "a" == item.tagName.toLowerCase() ? item : WebForm_GetElementByTagName(item, "a"), menu = Menu_FindMenu(a); try { item.data = eval(menu.id + "_Data") } catch (e) { } } return item.data } function Menu_HideItems(e) { document.body.__oldOnClick && (document.body.onclick = document.body.__oldOnClick, document.body.__oldOnClick = null), Menu_ClearInterval(), (!e || "undefined" == typeof e.tagName && e instanceof Event) && (e = __rootMenuItem); var t = e; if ("undefined" != typeof t && null != t && t.tagName && "table" == t.tagName.toLowerCase() || (t = WebForm_GetElementByTagName(t, "TABLE")), "undefined" != typeof t && null != t && t.tagName && "table" == t.tagName.toLowerCase()) { for (var i = t.rows ? t.rows : t.firstChild.rows, a = !1, n = 0; n < i.length; n++) if (i[n].id) { a = !0; break } var r, s, o; if (a) for (r = 0; r < i.length; r++) i[r].id ? (s = WebForm_GetElementById(i[r].id + "Items"), s && Menu_HideItems(s)) : i[r].cells[0] && (o = WebForm_GetElementByTagName(i[r].cells[0], "TABLE"), o && Menu_HideItems(o)); else if (i[0]) for (r = 0; r < i[0].cells.length; r++) i[0].cells[r].id ? (s = WebForm_GetElementById(i[0].cells[r].id + "Items"), s && Menu_HideItems(s)) : (o = WebForm_GetElementByTagName(i[0].cells[r], "TABLE"), o && Menu_HideItems(i[0].cells[r].firstChild)); e && e.id && PopOut_Hide(e.id) } } function Menu_HoverDisabled(e) { var t = "td" == e.tagName.toLowerCase() ? e : e.cells[0], i = Menu_GetData(e); i && (t = WebForm_GetElementByTagName(t, "table").rows[0].cells[0].childNodes[0], i.disappearAfter >= 200 && (__disappearAfter = i.disappearAfter), Menu_Expand(t, i.horizontalOffset, i.verticalOffset)) } function Menu_HoverDynamic(e) { var t = "td" == e.tagName.toLowerCase() ? e : e.cells[0], i = Menu_GetData(e); if (i) { var a = WebForm_GetElementByTagName(t, "table"); i.hoverClass && (a.hoverClass = i.hoverClass, WebForm_AppendToClassName(a, i.hoverClass)), t = a.rows[0].cells[0].childNodes[0], i.hoverHyperLinkClass && (t.hoverHyperLinkClass = i.hoverHyperLinkClass, WebForm_AppendToClassName(t, i.hoverHyperLinkClass)), i.disappearAfter >= 200 && (__disappearAfter = i.disappearAfter), Menu_Expand(t, i.horizontalOffset, i.verticalOffset) } } function Menu_HoverRoot(e) { var t = "td" == e.tagName.toLowerCase() ? e : e.cells[0], i = Menu_GetData(e); if (!i) return null; var a = WebForm_GetElementByTagName(t, "table"); return i.staticHoverClass && (a.hoverClass = i.staticHoverClass, WebForm_AppendToClassName(a, i.staticHoverClass)), t = a.rows[0].cells[0].childNodes[0], i.staticHoverHyperLinkClass && (t.hoverHyperLinkClass = i.staticHoverHyperLinkClass, WebForm_AppendToClassName(t, i.staticHoverHyperLinkClass)), t } function Menu_HoverStatic(e) { var t = Menu_HoverRoot(e), i = Menu_GetData(e); i && (__disappearAfter = i.disappearAfter, Menu_Expand(t, i.horizontalOffset, i.verticalOffset)) } function Menu_IsHorizontal(e) { if (e) { var t = e.tagName && "a" == e.tagName.toLowerCase ? e : WebForm_GetElementByTagName(e, "A"); if (!t) return !1; var i = t.parentNode.parentNode.parentNode.parentNode.parentNode; if (i.id) return !0 } return !1 } function Menu_IsSelectable(e) { return e && e.href } function Menu_Key(e) { var t; window.event ? t = window.event : (t = e, e = t.currentTarget); var i = t ? t.keyCode : -1, a = Menu_GetData(e); if (a) { var n, r, s, o = Menu_IsHorizontal(e), l = WebForm_GetElementByTagName(e, "A"); if (!o && 38 == i || o && 37 == i) { for (s = Menu_FindPrevious(e) ; s && s.disabled;) s = Menu_FindPrevious(s); if (s) return Menu_Focus(s), Menu_Expand(s, a.horizontalOffset, a.verticalOffset, !0), t.cancelBubble = !0, t.stopPropagation && t.stopPropagation(), void 0 } if (!o && 40 == i || o && 39 == i) { if (o) { var c = Menu_FindSubMenu(l); if (c && c.style && c.style.visibility && "hidden" == c.style.visibility.toLowerCase()) return Menu_Expand(l, a.horizontalOffset, a.verticalOffset, !0), t.cancelBubble = !0, t.stopPropagation && t.stopPropagation(), void 0 } for (n = Menu_FindNext(e) ; n && n.disabled;) n = Menu_FindNext(n); if (n) return Menu_Focus(n), Menu_Expand(n, a.horizontalOffset, a.verticalOffset, !0), t.cancelBubble = !0, t.stopPropagation && t.stopPropagation(), void 0 } if (!o && 39 == i || o && 40 == i) { var h = Menu_Expand(l, a.horizontalOffset, a.verticalOffset, !0); if (h) { var d; h = WebForm_GetElementsByTagName(h, "A"); for (var p = 0; p < h.length; p++) if (!h[p].disabled && Menu_IsSelectable(h[p])) { d = h[p]; break } if (d) return Menu_Focus(d), Menu_Expand(d, a.horizontalOffset, a.verticalOffset, !0), t.cancelBubble = !0, t.stopPropagation && t.stopPropagation(), void 0 } else { for (r = Menu_FindParentItem(e) ; r && !Menu_IsHorizontal(r) ;) r = Menu_FindParentItem(r); if (r) { for (n = Menu_FindNext(r) ; n && n.disabled;) n = Menu_FindNext(n); if (n) return Menu_Focus(n), Menu_Expand(n, a.horizontalOffset, a.verticalOffset, !0), t.cancelBubble = !0, t.stopPropagation && t.stopPropagation(), void 0 } } } if ((!o && 37 == i || o && 38 == i) && (r = Menu_FindParentItem(e))) { if (Menu_IsHorizontal(r)) { for (s = Menu_FindPrevious(r) ; s && s.disabled;) s = Menu_FindPrevious(s); if (s) return Menu_Focus(s), Menu_Expand(s, a.horizontalOffset, a.verticalOffset, !0), t.cancelBubble = !0, t.stopPropagation && t.stopPropagation(), void 0 } var u = WebForm_GetElementByTagName(r, "A"); return u && Menu_Focus(u), Menu_ResetSiblings(r), t.cancelBubble = !0, t.stopPropagation && t.stopPropagation(), void 0 } return 27 == i ? (Menu_HideItems(), t.cancelBubble = !0, t.stopPropagation && t.stopPropagation(), void 0) : void 0 } } function Menu_ResetSiblings(e) { for (var t = "td" == e.tagName.toLowerCase() ? e.parentNode.parentNode.parentNode : e.parentNode.parentNode, i = !1, a = 0; a < t.rows.length; a++) if (t.rows[a].id) { i = !0; break } var n, r, s; if (i) for (n = 0; n < t.rows.length; n++) s = t.rows[n], s != e && (r = WebForm_GetElementById(s.id + "Items"), r && Menu_HideItems(r)); else for (n = 0; n < t.rows[0].cells.length; n++) s = t.rows[0].cells[n], s != e && (r = WebForm_GetElementById(s.id + "Items"), r && Menu_HideItems(r)); Menu_ResetTopMenus(t, t, 0, !0) } function Menu_ResetTopMenus(e, t, i, a) { var n, r, s; if (a && "" == e.id) { var o = e.parentNode.parentNode.parentNode.parentNode; "table" == o.tagName.toLowerCase() && Menu_ResetTopMenus(o, t, i + 1, !0) } else if (0 == i && e != t) if (e.rows[0].id) for (n = 0; n < e.rows.length; n++) s = e.rows[n], r = WebForm_GetElementById(s.id + "Items"), r && Menu_HideItems(r); else for (n = 0; n < e.rows[0].cells.length; n++) s = e.rows[0].cells[n], r = WebForm_GetElementById(s.id + "Items"), r && Menu_HideItems(r); else if (i > 0) for (n = 0; n < e.rows.length; n++) for (var l = 0; l < e.rows[n].cells.length; l++) { var c = e.rows[n].cells[l].firstChild; c && "table" == c.tagName.toLowerCase() && Menu_ResetTopMenus(c, t, i - 1, !1) } } function Menu_RestoreInterval() { __menuInterval && __rootMenuItem && (Menu_ClearInterval(), __menuInterval = window.setInterval("Menu_HideItems()", __disappearAfter)) } function Menu_SetRoot(e) { var t = Menu_FindMenu(e); t && (__rootMenuItem && __rootMenuItem != t && Menu_HideItems(), __rootMenuItem = t) } function Menu_Unhover(e) { var t = "td" == e.tagName.toLowerCase() ? e : e.cells[0], i = WebForm_GetElementByTagName(t, "table"); i.hoverClass && WebForm_RemoveClassName(i, i.hoverClass), t = i.rows[0].cells[0].childNodes[0], t.hoverHyperLinkClass && WebForm_RemoveClassName(t, t.hoverHyperLinkClass), Menu_Collapse(t) } function PopOut_Clip(e, t, i) { e && e.style && (e.style.clip = "rect(" + t + "px auto " + (t + i) + "px auto)", e.style.overflow = "hidden") } function PopOut_Down(e) { Menu_ClearInterval(); var t; t = e ? e.parentNode : __scrollPanel, t && t.offset + t.clippedHeight < t.physicalHeight ? (PopOut_Scroll(t, 2), __scrollPanel = t, PopOut_ShowScrollers(t), PopOut_Stop(), __scrollPanel.interval = window.setInterval("PopOut_Down()", 8)) : PopOut_ShowScrollers(t) } function PopOut_Hide(e) { var t = WebForm_GetElementById(e); if (t && "div" == t.tagName.toLowerCase()) { t.style.visibility = "hidden", t.style.display = "none", t.offset = 0, t.scrollTop = 0; var i = WebForm_GetElementByTagName(t, "TABLE"); if (i && WebForm_SetElementY(i, 0), window.navigator && "Microsoft Internet Explorer" == window.navigator.appName && !window.opera) { var a = t.id + "_MenuIFrame", n = WebForm_GetElementById(a); n && (n.style.display = "none") } } } function PopOut_HideScrollers(e) { if (e && e.style) { var t = WebForm_GetElementById(e.id + "Up"), i = WebForm_GetElementById(e.id + "Dn"); t && (t.style.visibility = "hidden", t.style.display = "none"), i && (i.style.visibility = "hidden", i.style.display = "none") } } function PopOut_Position(e, t) { window.opera && (e.parentNode.removeChild(e), document.forms[0].appendChild(e)); var i = WebForm_GetElementById(e.rel), a = WebForm_GetElementByTagName(i, "TABLE"), n = WebForm_GetElementPosition(a ? a : i), r = WebForm_GetElementPosition(e), s = "undefined" != typeof e.physicalHeight && null != e.physicalHeight ? e.physicalHeight : r.height; e.physicalHeight = s; var o; e.offsetParent ? o = WebForm_GetElementPosition(e.offsetParent) : (o = new Object, o.x = 0, o.y = 0); var l = WebForm_GetElementById("__overFlowElement"); l || (l = document.createElement("img"), l.id = "__overFlowElement", WebForm_SetElementWidth(l, 1), document.body.appendChild(l)), WebForm_SetElementHeight(l, s + n.y + parseInt(e.y ? e.y : 0)), l.style.visibility = "visible", l.style.display = "inline"; var c = 0, h = 0; window.innerHeight ? (c = window.innerHeight, h = window.innerWidth) : document.documentElement && document.documentElement.clientHeight ? (c = document.documentElement.clientHeight, h = document.documentElement.clientWidth) : document.body && document.body.clientHeight && (c = document.body.clientHeight, h = document.body.clientWidth); var d = 0, p = 0; "undefined" != typeof window.pageYOffset ? (d = window.pageYOffset, p = window.pageXOffset) : document.documentElement && "undefined" != typeof document.documentElement.scrollTop ? (d = document.documentElement.scrollTop, p = document.documentElement.scrollLeft) : document.body && "undefined" != typeof document.body.scrollTop && (d = document.body.scrollTop, p = document.body.scrollLeft), l.style.visibility = "hidden", l.style.display = "none"; var u = c + d, f = h + p, g = e.pos; ("undefined" == typeof g || null == g || "" == g) && (g = "rtl" == WebForm_GetElementDir(i) ? "middleleft" : "middleright"), g = g.toLowerCase(); var m = n.y + parseInt(e.y ? e.y : 0) - o.y, v = i && i.parentNode && i.parentNode.parentNode && i.parentNode.parentNode.parentNode && "div" == i.parentNode.parentNode.parentNode.tagName.toLowerCase() ? i.parentNode.parentNode.parentNode : null; WebForm_SetElementY(e, m), PopOut_SetPanelHeight(e, s, !0); var _, y = !1; -1 != g.indexOf("top") ? (m -= s, WebForm_SetElementY(e, m), m < -o.y && (m = -o.y, WebForm_SetElementY(e, m), s > c - 2 && (y = !0, PopOut_SetPanelHeight(e, c - 2)))) : (-1 != g.indexOf("bottom") && (m += n.height, WebForm_SetElementY(e, m)), _ = m + o.y + s - u, _ > 0 && (m -= _, WebForm_SetElementY(e, m), m < -o.y && (m = 2 - o.y + d, WebForm_SetElementY(e, m), y = !0, PopOut_SetPanelHeight(e, c - 2)))), y || PopOut_SetPanelHeight(e, e.clippedHeight, !0); var b = 0; e.offsetParent && (b = WebForm_GetElementPosition(e.offsetParent).y); var x = "undefined" != typeof e.originY && null != e.originY ? e.originY : m - b; e.originY = x, t ? PopOut_HideScrollers(e) : PopOut_ShowScrollers(e); var w = n.x + parseInt(e.x ? e.x : 0) - o.x; v && v.clientLeft && (w += 2 * v.clientLeft), WebForm_SetElementX(e, w), -1 != g.indexOf("left") ? (w -= r.width, WebForm_SetElementX(e, w), w < -o.x && WebForm_SetElementX(e, -o.x)) : (-1 != g.indexOf("right") && (w += n.width, WebForm_SetElementX(e, w)), _ = w + o.x + r.width - f, _ > 0 && (w -= -1 == g.indexOf("bottom") && n.x > r.width ? n.width + r.width : _, WebForm_SetElementX(e, w), w < -o.x && WebForm_SetElementX(e, -o.x))) } function PopOut_Scroll(e, t) { var i = WebForm_GetElementByTagName(e, "TABLE"); if (i) { i.style.position = "relative"; var a = i.style.top ? parseInt(i.style.top) : 0; e.offset += t, WebForm_SetElementY(i, a - t) } } function PopOut_SetPanelHeight(e, t, i) { if (e && e.style) { var a = WebForm_GetElementPosition(e); e.physicalWidth = a.width, e.clippedHeight = t, WebForm_SetElementHeight(e, t - (e.clientTop ? 2 * e.clientTop : 0)), i && e.style ? e.style.clip = "rect(auto auto auto auto)" : PopOut_Clip(e, 0, t) } } function PopOut_Show(e, t, i) { var a = WebForm_GetElementById(e); if (a && "div" == a.tagName.toLowerCase()) { if (a.style.visibility = "visible", a.style.display = "inline", !a.offset || t) { a.scrollTop = 0, a.offset = 0; var n = WebForm_GetElementByTagName(a, "TABLE"); n && WebForm_SetElementY(n, 0) } PopOut_Position(a, t); var r = 1, s = window.navigator && "Microsoft Internet Explorer" == window.navigator.appName && !window.opera; if (s && i) { var o = a.id + "_MenuIFrame", l = WebForm_GetElementById(o), c = a.offsetParent; l || (l = document.createElement("iframe"), l.id = o, l.src = i.iframeUrl ? i.iframeUrl : "about:blank", l.style.position = "absolute", l.style.display = "none", l.scrolling = "no", l.frameBorder = "0", "html" == c.tagName.toLowerCase() ? document.body.appendChild(l) : c.appendChild(l)); var h = WebForm_GetElementPosition(a), d = WebForm_GetElementPosition(c); WebForm_SetElementX(l, h.x - d.x), WebForm_SetElementY(l, h.y - d.y), WebForm_SetElementWidth(l, h.width), WebForm_SetElementHeight(l, h.height), l.style.display = "block", a.currentStyle && a.currentStyle.zIndex && "auto" != a.currentStyle.zIndex ? r = a.currentStyle.zIndex : a.style.zIndex && (r = a.style.zIndex) } a.style.zIndex = r } } function PopOut_ShowScrollers(e) { if (e && e.style) { var t = WebForm_GetElementById(e.id + "Up"), i = WebForm_GetElementById(e.id + "Dn"), a = 0; t && i && (e.offset && e.offset > 0 ? (t.style.visibility = "visible", t.style.display = "inline", a++, e.clientWidth && WebForm_SetElementWidth(t, e.clientWidth - (t.clientLeft ? 2 * t.clientLeft : 0)), WebForm_SetElementY(t, 0)) : (t.style.visibility = "hidden", t.style.display = "none"), e.offset + e.clippedHeight + 2 <= e.physicalHeight ? (i.style.visibility = "visible", i.style.display = "inline", a++, e.clientWidth && WebForm_SetElementWidth(i, e.clientWidth - (i.clientLeft ? 2 * i.clientLeft : 0)), WebForm_SetElementY(i, e.clippedHeight - WebForm_GetElementPosition(i).height - (e.clientTop ? 2 * e.clientTop : 0))) : (i.style.visibility = "hidden", i.style.display = "none"), 0 == a && (e.style.clip = "rect(auto auto auto auto)")) } } function PopOut_Stop() { __scrollPanel && __scrollPanel.interval && window.clearInterval(__scrollPanel.interval), Menu_RestoreInterval() } function PopOut_Up(e) { Menu_ClearInterval(); var t; t = e ? e.parentNode : __scrollPanel, t && t.offset && t.offset > 0 && (PopOut_Scroll(t, -2), __scrollPanel = t, PopOut_ShowScrollers(t), PopOut_Stop(), __scrollPanel.interval = window.setInterval("PopOut_Up()", 8)) } var __rootMenuItem, __menuInterval, __scrollPanel, __disappearAfter = 500;