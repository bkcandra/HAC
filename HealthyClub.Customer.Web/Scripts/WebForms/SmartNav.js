var snSrc; if ("undefined" == typeof window.__smartNav || null == window.__smartNav) { window.__smartNav = new Object, window.__smartNav.update = function () { var e, t = window.__smartNav; document.detachEvent("onstop", t.stopHif), t.inPost = !1; try { e = frames.__hifSmartNav.document } catch (i) { return } var a = e.getElementsByTagName("asp_smartnav_rdir"); if (a.length > 0) { ("undefined" == typeof t.sHif || null == t.sHif) && (t.sHif = document.createElement("IFRAME"), t.sHif.name = "__hifSmartNav", t.sHif.style.display = "none", t.sHif.src = snSrc); try { window.location = a[0].url } catch (i) { } } else { var n = e.location.href, r = n.indexOf(snSrc); if ((-1 == r || r != n.length - snSrc.length) && "about:blank" != n) { var s = n.split("?")[0]; if (document.location.href.indexOf(s) < 0) return document.location.href = n, void 0; t._savedOnLoad = window.onload, window.onload = null, window.__smartNav.updateHelper() } } }, window.__smartNav.updateHelper = function () { return "complete" != document.readyState ? (window.setTimeout(window.__smartNav.updateHelper, 25), void 0) : (window.__smartNav.loadNewContent(), void 0) }, window.__smartNav.loadNewContent = function () { var sn = window.__smartNav, fd; try { fd = frames.__hifSmartNav.document } catch (e) { return } "undefined" != typeof sn.sHif && null != sn.sHif && (sn.sHif.removeNode(!0), sn.sHif = null); var hdm = document.getElementsByTagName("head")[0], hk = hdm.childNodes, tt = null, i; for (i = hk.length - 1; i >= 0; i--) "TITLE" != hk[i].tagName ? ("BASEFONT" != hk[i].tagName || 0 == hk[i].innerHTML.length) && hdm.removeChild(hdm.childNodes[i]) : tt = hk[i].outerHTML; var kids = fd.getElementsByTagName("head")[0].childNodes; for (i = 0; i < kids.length; i++) { var tn = kids[i].tagName, k = document.createElement(tn); switch (k.id = kids[i].id, k.mergeAttributes(kids[i]), tn) { case "TITLE": if (tt == kids[i].outerHTML) continue; k.innerText = kids[i].text, hdm.insertAdjacentElement("afterbegin", k); continue; case "BASEFONT": if (kids[i].innerHTML.length > 0) continue; break; default: var o = document.createElement("BODY"); o.innerHTML = "<BODY>" + kids[i].outerHTML + "</BODY>", k = o.firstChild } "undefined" != typeof k && null != k && hdm.appendChild(k) } document.body.clearAttributes(), document.body.id = fd.body.id, document.body.mergeAttributes(fd.body); var newBodyLoad = fd.body.onload; document.body.onload = "undefined" != typeof newBodyLoad && null != newBodyLoad ? newBodyLoad : sn._savedOnLoad; var s = "<BODY>" + fd.body.innerHTML + "</BODY>"; if ("undefined" != typeof sn.hif && null != sn.hif) { var hifP = sn.hif.parentElement; "undefined" != typeof hifP && null != hifP && (sn.sHif = hifP.removeChild(sn.hif)) } document.body.innerHTML = s; var sc = document.scripts; for (i = 0; i < sc.length; i++) sc[i].text = sc[i].text; if (sn.hif = document.all("__hifSmartNav"), "undefined" != typeof sn.hif && null != sn.hif) { var hif = sn.hif; sn.hifName = "__hifSmartNav" + (new Date).getTime(), frames.__hifSmartNav.name = sn.hifName, sn.hifDoc = hif.contentWindow.document, sn.ie5 && hif.parentElement.removeChild(hif), window.setTimeout(sn.restoreFocus, 0) } if ("string" == typeof window.onload) try { eval(window.onload) } catch (e) { } else if ("undefined" != typeof window.onload && null != window.onload) try { window.onload() } catch (e) { } sn._savedOnLoad = null, sn.attachForm() }, window.__smartNav.restoreFocus = function () { if (1 != window.__smartNav.inPost) { var e = document.activeElement, t = window.__smartNav.ae; if ("undefined" != typeof t && null != t && ("undefined" == typeof e || null == e || e.id != t && e.name != t)) { var i = document.all(t); if ("undefined" != typeof i && null != i) try { i.focus() } catch (a) { } } } }, window.__smartNav.saveHistory = function () { "undefined" != typeof window.__smartNav.hif && null != window.__smartNav.hif && window.__smartNav.hif.removeNode(), "undefined" != typeof window.__smartNav.sHif && null != window.__smartNav.sHif && "undefined" != typeof document.all[window.__smartNav.siHif] && null != document.all[window.__smartNav.siHif] && document.all[window.__smartNav.siHif].insertAdjacentElement("BeforeBegin", window.__smartNav.sHif) }, window.__smartNav.stopHif = function () { document.detachEvent("onstop", window.__smartNav.stopHif); var e = window.__smartNav; if (("undefined" == typeof e.hifDoc || null == e.hifDoc) && "undefined" != typeof e.hif && null != e.hif) try { e.hifDoc = e.hif.contentWindow.document } catch (t) { e.hifDoc = null } if (null != e.hifDoc) try { e.hifDoc.execCommand("stop") } catch (t) { } }, window.__smartNav.init = function () { var e = window.__smartNav; window.__smartNav.form.__smartNavPostBack.value = "true", document.detachEvent("onstop", e.stopHif), document.attachEvent("onstop", e.stopHif); try { if (0 == window.event.returnValue) return } catch (t) { } if (e.inPost = !0, "undefined" != typeof document.activeElement && null != document.activeElement) { var i = document.activeElement.id; 0 == i.length && (i = document.activeElement.name), e.ae = i } else e.ae = null; try { document.selection.empty() } catch (t) { } if (("undefined" == typeof e.hif || null == e.hif) && (e.hif = document.all("__hifSmartNav"), e.hifDoc = e.hif.contentWindow.document), "undefined" != typeof e.hifDoc && null != e.hifDoc) try { e.hifDoc.designMode = "On" } catch (t) { } ("undefined" == typeof e.hif.parentElement || null == e.hif.parentElement) && document.body.appendChild(e.hif); var a = e.hif; a.detachEvent("onload", e.update), a.attachEvent("onload", e.update), window.__smartNav.fInit = !0 }, window.__smartNav.submit = function () { window.__smartNav.fInit = !1; try { window.__smartNav.init() } catch (e) { } window.__smartNav.fInit && window.__smartNav.form._submit() }, window.__smartNav.attachForm = function () { for (var e = document.forms, t = 0; t < e.length; t++) if ("undefined" != typeof e[t].__smartNavEnabled && null != e[t].__smartNavEnabled) { window.__smartNav.form = e[t], window.__smartNav.form.insertAdjacentHTML("beforeEnd", "<input type='hidden' name='__smartNavPostBack' value='false' />"); break } var i = window.__smartNav.form; if ("undefined" == typeof i || null == i) return !1; var a = i.target; if (0 != a.length && 0 != a.indexOf("__hifSmartNav")) return !1; var n = i.action.split("?")[0], r = window.location.href.split("?")[0]; return "/" != r.charAt(r.length - 1) && r.lastIndexOf(n) + n.length != r.length ? !1 : 1 == i.__formAttached ? !0 : (i.__formAttached = !0, i.attachEvent("onsubmit", window.__smartNav.init), i._submit = i.submit, i.submit = window.__smartNav.submit, i.target = window.__smartNav.hifName, !0) }, window.__smartNav.hifName = "__hifSmartNav" + (new Date).getTime(), window.__smartNav.ie5 = navigator.appVersion.indexOf("MSIE 5") > 0; var rc = window.__smartNav.attachForm(), hif = document.all("__hifSmartNav"); if (("undefined" == typeof snSrc || null == snSrc) && ("undefined" != typeof window.dialogHeight ? (snSrc = "IEsmartnav1", hif.src = snSrc) : snSrc = hif.src), rc) { var fsn = frames.__hifSmartNav; fsn.name = window.__smartNav.hifName, window.__smartNav.siHif = hif.sourceIndex; try { fsn.document.location != snSrc && (fsn.document.designMode = "On", hif.attachEvent("onload", window.__smartNav.update), window.__smartNav.hif = hif) } catch (e) { window.__smartNav.hif = hif } window.attachEvent("onbeforeunload", window.__smartNav.saveHistory) } else window.__smartNav = null }