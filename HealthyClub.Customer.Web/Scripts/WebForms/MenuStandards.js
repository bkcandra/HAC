window.Sys || (window.Sys = {}), Sys.WebForms || (Sys.WebForms = {}), Sys.WebForms.Menu = function (t) { if (this.items = [], this.depth = t.depth || 1, this.parentMenuItem = t.parentMenuItem, this.element = Sys.WebForms.Menu._domHelper.getElement(t.element), "DIV" === this.element.tagName) { var e = this.element; this.element = Sys.WebForms.Menu._domHelper.firstChild(e), this.element.tabIndex = t.tabIndex || 0, t.element = e, t.menu = this, this.container = new Sys.WebForms._MenuContainer(t), Sys.WebForms.Menu._domHelper.setFloat(this.element, this.container.rightToLeft ? "right" : "left") } else this.container = t.container, this.keyMap = t.keyMap; Sys.WebForms.Menu._elementObjectMapper.map(this.element, this), this.parentMenuItem && this.parentMenuItem.parentMenu && (this.parentMenu = this.parentMenuItem.parentMenu, this.rootMenu = this.parentMenu.rootMenu, this.element.id || (this.element.id = (this.container.element.id || "menu") + ":submenu:" + Sys.WebForms.Menu._elementObjectMapper._computedId), this.depth > this.container.staticDisplayLevels ? (this.displayMode = "dynamic", this.element.style.display = "none", this.element.style.position = "absolute", this.rootMenu && "horizontal" === this.container.orientation && this.parentMenu.isStatic() ? (this.element.style.top = "100%", this.container.rightToLeft ? this.element.style.right = "0px" : this.element.style.left = "0px") : (this.element.style.top = "0px", this.container.rightToLeft ? this.element.style.right = "100%" : this.element.style.left = "100%"), this.keyMap = this.container.rightToLeft ? Sys.WebForms.Menu._keyboardMapping.verticalRtl : Sys.WebForms.Menu._keyboardMapping.vertical) : (this.displayMode = "static", this.element.style.display = "block", "horizontal" === this.container.orientation && Sys.WebForms.Menu._domHelper.setFloat(this.element, this.container.rightToLeft ? "right" : "left"))), Sys.WebForms.Menu._domHelper.appendCssClass(this.element, this.displayMode); for (var i = this.element.childNodes, n = i.length, r = 0; n > r; r++) { var o = i[r]; if (1 === o.nodeType) { var s = null; this.parentMenuItem && (s = this.parentMenuItem.topLevelMenuItem); var a = new Sys.WebForms.MenuItem(this, o, s), l = this.items[this.items.length - 1]; l && (a.previousSibling = l, l.nextSibling = a), this.items[this.items.length] = a } } }, Sys.WebForms.Menu.prototype = { blur: function () { this.container && this.container.blur() }, collapse: function () { this.each(function (t) { t.hover(!1), t.blur(); var e = t.childMenu; e && e.collapse() }), this.hide() }, doDispose: function () { this.each(function (t) { t.doDispose() }) }, each: function (t) { for (var e = this.items.length, i = 0; e > i; i++) t(this.items[i]) }, firstChild: function () { return this.items[0] }, focus: function () { this.container && this.container.focus() }, get_displayed: function () { return "none" !== this.element.style.display }, get_focused: function () { return this.container ? this.container.focused : !1 }, handleKeyPress: function (t) { if (this.keyMap.contains(t)) { if (this.container.focusedMenuItem) return this.container.focusedMenuItem.navigate(t), void 0; var e = this.firstChild(); e && this.container.navigateTo(e) } }, hide: function () { this.get_displayed() && (this.each(function (t) { t.childMenu && t.childMenu.hide() }), this.isRoot() || (this.get_focused() && this.container.navigateTo(this.parentMenuItem), this.element.style.display = "none")) }, isRoot: function () { return this.rootMenu === this }, isStatic: function () { return "static" === this.displayMode }, lastChild: function () { return this.items[this.items.length - 1] }, show: function () { this.element.style.display = "block" } }, Sys.WebForms.Menu.registerClass && Sys.WebForms.Menu.registerClass("Sys.WebForms.Menu"), Sys.WebForms.MenuItem = function (t, e, i) { for (this.keyMap = t.keyMap, this.parentMenu = t, this.container = t.container, this.element = e, this.topLevelMenuItem = i || this, this._anchor = Sys.WebForms.Menu._domHelper.firstChild(e) ; this._anchor && "A" !== this._anchor.tagName;) this._anchor = Sys.WebForms.Menu._domHelper.nextSibling(this._anchor); if (this._anchor) { this._anchor.tabIndex = -1; for (var n = this._anchor; n && "UL" !== n.tagName;) n = Sys.WebForms.Menu._domHelper.nextSibling(n); n && (this.childMenu = new Sys.WebForms.Menu({ element: n, parentMenuItem: this, depth: t.depth + 1, container: this.container, keyMap: this.keyMap }), this.childMenu.isStatic() || (Sys.WebForms.Menu._domHelper.appendCssClass(this.element, "has-popup"), Sys.WebForms.Menu._domHelper.appendAttributeValue(this.element, "aria-haspopup", this.childMenu.element.id))) } Sys.WebForms.Menu._elementObjectMapper.map(e, this), Sys.WebForms.Menu._domHelper.appendAttributeValue(e, "role", "menuitem"), Sys.WebForms.Menu._domHelper.appendCssClass(e, t.displayMode), this._anchor && Sys.WebForms.Menu._domHelper.appendCssClass(this._anchor, t.displayMode), this.element.style.position = "relative", 1 == this.parentMenu.depth && "horizontal" == this.container.orientation && Sys.WebForms.Menu._domHelper.setFloat(this.element, this.container.rightToLeft ? "right" : "left"), this.container.disabled || (Sys.WebForms.Menu._domHelper.addEvent(this.element, "mouseover", Sys.WebForms.MenuItem._onmouseover), Sys.WebForms.Menu._domHelper.addEvent(this.element, "mouseout", Sys.WebForms.MenuItem._onmouseout)) }, Sys.WebForms.MenuItem.prototype = { applyUp: function (t, e) { e = e || function (t) { return t }; for (var i = this, n = null; e(i) ;) t(i), n = i, i = i.parentMenu.parentMenuItem; return n }, blur: function () { this.setTabIndex(-1) }, doDispose: function () { Sys.WebForms.Menu._domHelper.removeEvent(this.element, "mouseover", Sys.WebForms.MenuItem._onmouseover), Sys.WebForms.Menu._domHelper.removeEvent(this.element, "mouseout", Sys.WebForms.MenuItem._onmouseout), this.childMenu && this.childMenu.doDispose() }, focus: function () { this.parentMenu.get_displayed() || this.parentMenu.show(), this.setTabIndex(0), this.container.focused = !0, this._anchor.focus() }, get_highlighted: function () { return /(^|\s)highlighted(\s|$)/.test(this._anchor.className) }, getTabIndex: function () { return this._anchor.tabIndex }, highlight: function (t) { t ? (this.applyUp(function (t) { t.parentMenu.parentMenuItem.highlight(!0) }, function (t) { return !t.parentMenu.isStatic() && t.parentMenu.parentMenuItem }), Sys.WebForms.Menu._domHelper.appendCssClass(this._anchor, "highlighted")) : (Sys.WebForms.Menu._domHelper.removeCssClass(this._anchor, "highlighted"), this.setTabIndex(-1)) }, hover: function (t) { if (t) { var e = this.container.hoveredMenuItem; e && e.hover(!1); var i = this.container.focusedMenuItem; i && i !== this && i.hover(!1), this.applyUp(function (t) { t.childMenu && !t.childMenu.get_displayed() && t.childMenu.show() }), this.container.hoveredMenuItem = this, this.highlight(!0) } else for (var n = this; n;) n.highlight(!1), n.childMenu && (n.childMenu.isStatic() || n.childMenu.hide()), n = n.parentMenu.parentMenuItem }, isSiblingOf: function (t) { return t.parentMenu === this.parentMenu }, mouseout: function () { var t = this, e = this.container.pendingMouseoutId, i = this.container.disappearAfter; e && window.clearTimeout(e), i > -1 && (this.container.pendingMouseoutId = window.setTimeout(function () { t.hover(!1) }, i)) }, mouseover: function () { var t = this.container.pendingMouseoutId; t && (window.clearTimeout(t), this.container.pendingMouseoutId = null), this.hover(!0), this.container.menu.get_focused() && this.container.navigateTo(this) }, navigate: function (t) { switch (this.keyMap[t]) { case this.keyMap.next: this.navigateNext(); break; case this.keyMap.previous: this.navigatePrevious(); break; case this.keyMap.child: this.navigateChild(); break; case this.keyMap.parent: this.navigateParent(); break; case this.keyMap.tab: this.navigateOut() } }, navigateChild: function () { var t = this.childMenu; if (t) { var e = t.firstChild(); e && this.container.navigateTo(e) } else if ("horizontal" === this.container.orientation) { var i = this.topLevelMenuItem.nextSibling || this.topLevelMenuItem.parentMenu.firstChild(); if (i == this.topLevelMenuItem) return; this.topLevelMenuItem.childMenu.hide(), this.container.navigateTo(i), i.childMenu && this.container.navigateTo(i.childMenu.firstChild()) } }, navigateNext: function () { this.childMenu && this.childMenu.hide(); var t = this.nextSibling; !t && this.parentMenu.isRoot() && (t = this.parentMenu.parentMenuItem, t && (t = t.nextSibling)), t || (t = this.parentMenu.firstChild()), t && this.container.navigateTo(t) }, navigateOut: function () { this.parentMenu.blur() }, navigateParent: function () { var t = this.parentMenu, e = "horizontal" === this.container.orientation; if (t) { if (e && this.childMenu && t.isRoot()) return this.navigateChild(), void 0; if (t.parentMenuItem && !t.isRoot()) if (e && 2 === this.parentMenu.depth) { var i = this.parentMenu.parentMenuItem.previousSibling; i || (i = this.parentMenu.rootMenu.lastChild()), this.topLevelMenuItem.childMenu.hide(), this.container.navigateTo(i), i.childMenu && this.container.navigateTo(i.childMenu.firstChild()) } else this.parentMenu.hide() } }, navigatePrevious: function () { this.childMenu && this.childMenu.hide(); var t = this.previousSibling; if (t) { var e = t.childMenu; e && e.isRoot() && (t = e.lastChild()) } !t && this.parentMenu.isRoot() && (t = this.parentMenu.parentMenuItem), t || (t = this.parentMenu.lastChild()), t && this.container.navigateTo(t) }, setTabIndex: function (t) { this._anchor && (this._anchor.tabIndex = t) } }, Sys.WebForms.MenuItem._onmouseout = function (t) { var e = Sys.WebForms.Menu._elementObjectMapper.getMappedObject(this); e && (e.mouseout(), Sys.WebForms.Menu._domHelper.cancelEvent(t)) }, Sys.WebForms.MenuItem._onmouseover = function (t) { var e = Sys.WebForms.Menu._elementObjectMapper.getMappedObject(this); e && (e.mouseover(), Sys.WebForms.Menu._domHelper.cancelEvent(t)) }, Sys.WebForms.Menu._domHelper = { addEvent: function (t, e, i, n) { t.addEventListener ? t.addEventListener(e, i, !!n) : t["on" + e] = i }, appendAttributeValue: function (t, e, i) { this.updateAttributeValue("append", t, e, i) }, appendCssClass: function (t, e) { this.updateClassName("append", t, name, e) }, appendString: function (t, e, i) { var n = t(); if (!n) return e(i), void 0; var r = this._regexes.getRegex("(^| )" + i + "($| )"); r.test(n) || e(n + " " + i) }, cancelEvent: function (t) { var e = t || window.event; e && (e.cancelBubble = !0, e.stopPropagation && e.stopPropagation()) }, contains: function (t, e) { for (; e && e !== t; e = e.parentNode); return !!e }, firstChild: function (t) { var e = t.firstChild; return e && 1 !== e.nodeType && (e = this.nextSibling(e)), e }, getElement: function (t) { return "string" == typeof t ? document.getElementById(t) : t }, getElementDirection: function (t) { return t ? t.dir ? t.dir : this.getElementDirection(t.parentNode) : "ltr" }, getKeyCode: function (t) { return t.keyCode || t.charCode || 0 }, insertAfter: function (t, e) { var i = t.nextSibling; i ? t.parentNode.insertBefore(e, i) : t.parentNode && t.parentNode.appendChild(e) }, nextSibling: function (t) { for (var e = t.nextSibling; e;) { if (1 === e.nodeType) return e; e = e.nextSibling } }, removeAttributeValue: function (t, e, i) { this.updateAttributeValue("remove", t, e, i) }, removeCssClass: function (t, e) { this.updateClassName("remove", t, name, e) }, removeEvent: function (t, e, i, n) { t.removeEventListener ? t.removeEventListener(e, i, !!n) : t.detachEvent && t.detachEvent("on" + e, i), t["on" + e] = null }, removeString: function (t, e, i) { var n = t(); if (n) { var r = this._regexes.getRegex("(\\s|\\b)" + i + "$|\\b" + i + "\\s+"); e(n.replace(r, "")) } }, setFloat: function (t, e) { t.style.styleFloat = e, t.style.cssFloat = e }, updateAttributeValue: function (t, e, i, n) { this[t + "String"](function () { return e.getAttribute(i) }, function (t) { e.setAttribute(i, t) }, n) }, updateClassName: function (t, e, i, n) { this[t + "String"](function () { return e.className }, function (t) { e.className = t }, n) }, _regexes: { getRegex: function (t) { var e = this[t]; return e || (this[t] = e = new RegExp(t)), e } } }, Sys.WebForms.Menu._elementObjectMapper = { _computedId: 0, _mappings: {}, _mappingIdName: "Sys.WebForms.Menu.Mapping", getMappedObject: function (t) { var e = t[this._mappingIdName]; return e ? this._mappings[this._mappingIdName + ":" + e] : void 0 }, map: function (t, e) { var i = t[this._mappingIdName]; if (i !== e) { var n = t[this._mappingIdName] || t.id || "%" + ++this._computedId; t[this._mappingIdName] = n, this._mappings[this._mappingIdName + ":" + n] = e, e.mappingId = n } } }, Sys.WebForms.Menu._keyboardMapping = new function () { var t = 37, e = 38, i = 39, n = 40, r = 9, o = 27; this.vertical = { next: 0, previous: 1, child: 2, parent: 3, tab: 4 }, this.vertical[n] = this.vertical.next, this.vertical[e] = this.vertical.previous, this.vertical[i] = this.vertical.child, this.vertical[t] = this.vertical.parent, this.vertical[r] = this.vertical[o] = this.vertical.tab, this.verticalRtl = { next: 0, previous: 1, child: 2, parent: 3, tab: 4 }, this.verticalRtl[n] = this.verticalRtl.next, this.verticalRtl[e] = this.verticalRtl.previous, this.verticalRtl[t] = this.verticalRtl.child, this.verticalRtl[i] = this.verticalRtl.parent, this.verticalRtl[r] = this.verticalRtl[o] = this.verticalRtl.tab, this.horizontal = { next: 0, previous: 1, child: 2, parent: 3, tab: 4 }, this.horizontal[i] = this.horizontal.next, this.horizontal[t] = this.horizontal.previous, this.horizontal[n] = this.horizontal.child, this.horizontal[e] = this.horizontal.parent, this.horizontal[r] = this.horizontal[o] = this.horizontal.tab, this.horizontalRtl = { next: 0, previous: 1, child: 2, parent: 3, tab: 4 }, this.horizontalRtl[i] = this.horizontalRtl.previous, this.horizontalRtl[t] = this.horizontalRtl.next, this.horizontalRtl[n] = this.horizontalRtl.child, this.horizontalRtl[e] = this.horizontalRtl.parent, this.horizontalRtl[r] = this.horizontalRtl[o] = this.horizontalRtl.tab, this.horizontal.contains = this.horizontalRtl.contains = this.vertical.contains = this.verticalRtl.contains = function (t) { return null != this[t] } }, Sys.WebForms._MenuContainer = function (t) { this.focused = !1, this.disabled = t.disabled, this.staticDisplayLevels = t.staticDisplayLevels || 1, this.element = t.element, this.orientation = t.orientation || "vertical", this.disappearAfter = t.disappearAfter, this.rightToLeft = "rtl" === Sys.WebForms.Menu._domHelper.getElementDirection(this.element), Sys.WebForms.Menu._elementObjectMapper.map(this.element, this), this.menu = t.menu, this.menu.rootMenu = this.menu, this.menu.displayMode = "static", this.menu.element.style.position = "relative", this.menu.element.style.width = "auto", "vertical" === this.orientation ? (Sys.WebForms.Menu._domHelper.appendAttributeValue(this.menu.element, "role", "menu"), this.menu.keyMap = this.rightToLeft ? Sys.WebForms.Menu._keyboardMapping.verticalRtl : Sys.WebForms.Menu._keyboardMapping.vertical) : (Sys.WebForms.Menu._domHelper.appendAttributeValue(this.menu.element, "role", "menubar"), this.menu.keyMap = this.rightToLeft ? Sys.WebForms.Menu._keyboardMapping.horizontalRtl : Sys.WebForms.Menu._keyboardMapping.horizontal); var e = document.createElement("div"); if (e.style.clear = this.rightToLeft ? "right" : "left", this.element.appendChild(e), Sys.WebForms.Menu._domHelper.setFloat(this.element, this.rightToLeft ? "right" : "left"), Sys.WebForms.Menu._domHelper.insertAfter(this.element, e), !this.disabled) { Sys.WebForms.Menu._domHelper.addEvent(this.menu.element, "focus", this._onfocus, !0), Sys.WebForms.Menu._domHelper.addEvent(this.menu.element, "keydown", this._onkeydown); var i = this; this.element.dispose = function () { i.element.dispose && (i.element.dispose = null, Sys.WebForms.Menu._domHelper.removeEvent(i.menu.element, "focus", i._onfocus, !0), Sys.WebForms.Menu._domHelper.removeEvent(i.menu.element, "keydown", i._onkeydown), i.menu.doDispose()) }, Sys.WebForms.Menu._domHelper.addEvent(window, "unload", function () { i.element.dispose && i.element.dispose() }) } }, Sys.WebForms._MenuContainer.prototype = { blur: function () { this.focused = !1, this.isBlurring = !1, this.menu.collapse(), this.focusedMenuItem = null }, focus: function () { this.focused = !0 }, navigateTo: function (t) { this.focusedMenuItem && this.focusedMenuItem !== this && this.focusedMenuItem.highlight(!1), t.highlight(!0), t.focus(), this.focusedMenuItem = t }, _onfocus: function (t) { var e = t || window.event; e.srcElement && this && Sys.WebForms.Menu._domHelper.contains(this.element, e.srcElement) && (this.focused || this.focus()) }, _onkeydown: function (t) { var e = Sys.WebForms.Menu._elementObjectMapper.getMappedObject(this), i = Sys.WebForms.Menu._domHelper.getKeyCode(t || window.event); e && e.handleKeyPress(i) } };